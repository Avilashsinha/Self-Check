<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Safe Self Vulnerability Check</title>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXX"></script>
  <style>
    :root{--bg:#0f172a;--card:rgba(255,255,255,0.05);--accent:#3b82f6;--accent2:#06b6d4;--muted:#94a3b8;--text:#f8fafc}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);margin:0;padding:28px;color:var(--text)}
    .container{max-width:960px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px;margin-bottom:20px}
    h1{font-size:24px;margin:0;background:linear-gradient(135deg,var(--accent),var(--accent2));background-clip:text;-webkit-text-fill-color:transparent}
    p.lead{margin:6px 0 0;color:var(--muted)}
    .card{background:var(--card);border-radius:16px;padding:20px;backdrop-filter:blur(12px);box-shadow:0 6px 18px rgba(0,0,0,0.4);margin-bottom:18px}
    .grid{display:grid;grid-template-columns:1fr 320px;gap:18px}
    label{display:block;font-weight:600;margin-bottom:6px}
    input[type=text],textarea,select{width:100%;padding:10px;border:1px solid #1e293b;border-radius:8px;font-size:14px;background:#1e293b;color:var(--text)}
    button{background:linear-gradient(135deg,var(--accent),var(--accent2));color:white;border:none;padding:12px 16px;border-radius:10px;font-weight:700;cursor:pointer;transition:all .2s ease}
    button:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,0.6)}
    ul.checks{list-style:none;padding:0;margin:0}
    ul.checks li{padding:10px;border-radius:8px;margin-bottom:8px;background:rgba(59,130,246,0.1);border:1px solid rgba(59,130,246,0.3)}
    .ok{color:#22c55e;font-weight:700}
    .warn{color:#eab308;font-weight:700}
    .danger{color:#ef4444;font-weight:700}
    .muted{color:var(--muted)}
    .small{font-size:13px;color:var(--muted)}
    .report-json{white-space:pre-wrap;overflow:auto;max-height:280px;padding:10px;background:#1e293b;color:#f8fafc;border-radius:8px;font-size:13px}
    footer{font-size:13px;color:var(--muted);margin-top:8px;text-align:center}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div style="width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,#1e293b,#334155);display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--text)">V</div>
      <div>
        <h1>Safe Self Vulnerability Check</h1>
        <p class="lead">A privacy-first, <strong>non-invasive</strong> web tool to help you check common security posture items for your own device. <span class="muted">(No remote port-scanning or exploitation.)</span></p>
      </div>
    </header>

    <div class="grid">
      <main class="card">
        <h2 style="margin-top:0">Run local checks</h2>
        <p class="small">These checks run in your browser and examine only information your browser exposes. They are safe and cannot probe other machines.</p>

        <button id="runChecks">Run quick check</button>
        <div style="height:12px"></div>
        <ul id="results" class="checks" aria-live="polite"></ul>

        <section style="margin-top:12px">
          <h3>Results JSON</h3>
          <div id="jsonView" class="report-json">No report yet — run checks first.</div>
          <p class="small">Copy and paste this result into the analyze report section below for deeper analysis.</p>
        </section>

        <section style="margin-top:12px">
          <h3>Manual input / Paste system report</h3>
          <p class="small">If you want deeper analysis, paste a system report (ipconfig, ifconfig, systeminfo) and the tool will highlight common risky signs (like exposed RDP, public IP without firewall hints, or plain-text credentials). <strong>Do not paste secrets or private keys.</strong></p>
          <textarea id="sysreport" rows="6" placeholder="Paste system report or network info here..."></textarea>
          <div style="height:8px"></div>
          <button id="analyzeReport">Analyze report</button>
          <div id="reportAnalysis" style="margin-top:10px"></div>
        </section>

        <section style="margin-top:12px">
          <h3>Password strength tester</h3>
          <p class="small">Type a password to see a quick strength estimate (won't be sent anywhere).</p>
          <input id="pwd" type="text" placeholder="Type a password (not sent)"> <div style="height:8px"></div>
          <div id="pwdResult" class="small"></div>
        </section>

        <section style="margin-top:12px">
          <h3>Export report</h3>
          <p class="small">Download the findings as a JSON file you can keep for your records.</p>
          <button id="downloadReport">Download Report</button>
        </section>

      </main>

      <aside class="card">
        <h3 style="margin-top:0">What this checks</h3>
        <ul class="small">
          <li>Browser and OS detection (helps identify outdated clients)</li>
          <li>Connection security (HTTPS / secure context)</li>
          <li>Cookie & tracking settings (Do Not Track, cookieEnabled)</li>
          <li>Feature checks (WebAuthn availability, Service Worker)</li>
          <li>Password strength estimator</li>
        </ul>

        <div style="height:12px"></div>
        <h4>Important — permissions & ethics</h4>
        <p class="small">Only test systems you own or have explicit permission to test. This page purposefully avoids any active network scanning or exploitation features. For authorized professional testing, use established tools (e.g., Nessus, OpenVAS, OWASP ZAP) from a secured environment.</p>

        <div style="height:12px"></div>
        <h4>Quick tips</h4>
        <ul class="small">
          <li>Use a password manager and enable MFA (WebAuthn when available).</li>
          <li>Keep OS & browser up to date.</li>
          <li>Run authorized vulnerability scans from a dedicated machine or VM.</li>
        </ul>

      </aside>
    </div>

    <footer class="small card">
      <strong>Disclaimer:</strong> This tool provides basic, non-invasive checks and high-level advice only. It is not a substitute for a professional security assessment. Never disclose credentials or private keys here.<br>
      <br>Created by <strong>Avilash Sinha Roy</strong>
    </footer>
  </div>

  <script>
    const $ = id => document.getElementById(id);
    const state = {results:[],report:{}};

    function addResult(title, level, detail){
      state.results.push({title,level,detail});
      const li = document.createElement('li');
      li.innerHTML = `<strong>${title}</strong><div class='small'>${detail || ''}</div>`;
      li.className = level==='ok'?'ok':(level==='warn'?'warn':'danger');
      $('results').appendChild(li);
      $('jsonView').textContent = JSON.stringify(state.report, null, 2);
    }

    function clearResults(){
      state.results = [];
      state.report = {timestamp:new Date().toISOString(),checks:[]};
      $('results').innerHTML = '';
      $('jsonView').textContent = 'No report yet — run checks first.';
    }

    function runQuickChecks(){
      clearResults();

      const secure = window.isSecureContext;
      state.report.secureContext = secure;
      addResult('Secure context (HTTPS)', secure? 'ok':'warn', secure? 'This page is loaded in a secure context.':'This page is NOT in a secure context. Avoid entering secrets on non-HTTPS pages.');

      const ua = navigator.userAgent || '';
      const platform = navigator.platform || 'unknown';
      state.report.userAgent = ua; state.report.platform = platform;
      addResult('Browser / Platform', 'ok', ua.replace(/\s+\s+/g,' '));

      const cookies = navigator.cookieEnabled;
      state.report.cookiesEnabled = cookies;
      addResult('Cookies enabled', cookies? 'ok':'warn', cookies? 'Cookies are enabled.':'Cookies are disabled — some sites may not function properly.');

      const dnt = navigator.doNotTrack || navigator.msDoNotTrack || window.doNotTrack;
      state.report.doNotTrack = dnt;
      addResult('Do Not Track header', dnt? 'ok':'warn', dnt? `Value: ${dnt}` : 'Not set — some trackers may function normally.');

      const webauthn = !!(window.PublicKeyCredential);
      state.report.webauthn = webauthn;
      addResult('WebAuthn available', webauthn? 'ok':'warn', webauthn? 'Your browser supports WebAuthn (good for MFA).' : 'WebAuthn not available — consider other MFA options.');

      const sw = 'serviceWorker' in navigator;
      state.report.serviceWorker = sw;
      addResult('Service Worker support', sw? 'ok':'warn', sw? 'Service Workers supported.' : 'Service Workers not supported.');

      state.report.origin = location.origin;
      addResult('Origin', 'ok', location.origin);

      const autofillTest = (function(){ try { return ('credentials' in navigator) } catch(e){ return false } })();
      state.report.credentialsAPI = autofillTest;
      addResult('Credentials API available', autofillTest? 'ok':'warn', autofillTest? 'Browser supports credential management APIs.' : 'Credential APIs not available — still OK.');

      state.report.checks = state.results;
      $('jsonView').textContent = JSON.stringify(state.report, null, 2);
    }

    function analyzeReportText(txt){
      const out = [];
      const lowered = txt.toLowerCase();
      if(!txt.trim()){ return '<div class="small muted">Paste a system report to analyze.</div>'; }
      if(/rdp|3389/.test(lowered)) out.push({level:'warn',msg:'RDP mentions detected (port 3389). Ensure it is firewalled and not publicly accessible.'});
      if(/telnet|23\b/.test(lowered)) out.push({level:'danger',msg:'Telnet mentions detected (port 23) — avoid Telnet, use SSH.'});
      if(/password\s*[:=]/.test(lowered)) out.push({level:'danger',msg:'Possible plaintext password(s) found in report — remove secrets before sharing.'});
      if(/administrator|admin\s*:/i.test(txt)) out.push({level:'warn',msg:'Default admin accounts mentioned — ensure they have strong passwords and are disabled if unused.'});
      if(/public ip|internet ip/.test(lowered)) out.push({level:'warn',msg:'Public IP observed — verify host firewalling and exposed services.'});
      if(out.length===0) return '<div class="small">No obvious red flags found in the pasted text (basic pattern checks only).</div>';
      return out.map(o=>`<div class='${o.level}'>${o.msg}</div>`).join('\n');
    }

    function scorePassword(p){
      if(!p) return {score:0,label:'empty'};
      let score = 0;
      if(p.length>=8) score +=1; if(p.length>=12) score +=1;
      if(/[a-z]/.test(p) && /[A-Z]/.test(p)) score +=1;
      if(/\d/.test(p)) score +=1;
      if(/[^A-Za-z0-9]/.test(p)) score +=1;
      const label = score>=4? 'Strong' : (score>=3? 'Medium' : 'Weak');
      return {score,label};
    }

    $('runChecks').addEventListener('click', ()=>{ runQuickChecks(); });
    $('analyzeReport').addEventListener('click', ()=>{ $('reportAnalysis').innerHTML = analyzeReportText($('sysreport').value); });
    $('pwd').addEventListener('input', e=>{ const res = scorePassword(e.target.value); $('pwdResult').textContent = `Strength: ${res.label} (${res.score}/5)`; });
    $('downloadReport').addEventListener('click', ()=>{
      const blob = new Blob([JSON.stringify(state.report, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'vulnerability-self-check.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    window.addEventListener('DOMContentLoaded', ()=>{ runQuickChecks(); });
  </script>
</body>
</html>
